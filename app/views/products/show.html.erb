<% provide(:page_title, @product.name) %>
<% provide(:product_active, "active") %>

<div class="row">
  <div class="col-md-4 mt-5">
    <%= image_tag(@product.image_url, class: "img-fluid") %>  
  </div>
  <div class="col-md-6">
    <h3 class="card-title"><%= @product.name %></h3>
    <p class="card-text"><%= @product.description.html_safe %></p>
    <li class="list-group-item">Colour: <%= @product.colour ? @product.colour : "Not specified" %><i class="ml-2 fas fa-palette"></i></li>
    <li class="list-group-item">Price: EUR <%= @product.converted_price %><i class="ml-2 fas fa-shopping-cart"></i></li>
    <p class="mt-2">Average Rating: <div class="rated" data-score="<%= @product.average_rating %>"></div></p>
    <% if signed_in? %>
      <%= form_with(url: '/payments/create') do |form| %>
        <%= render partial: "shared/stripe_checkout_button" %>
        <%= hidden_field_tag(:product_id, @product.id) %>
      <% end %>
    <% end %>
  </div>
  <div class="col-md-2 box">
    <%= button_to 'Add to Cart', {:controller => "orders", :action => "create", :product => @product } , :method=>:post, class: "btn btn-success btn-block"  %>
    <div class="text-center mt-3">
      <% if signed_in? && current_user.admin? %>
        <%= link_to 'Edit', edit_product_path(@product) %> |
      <% end %>
      <%= link_to 'Back', products_path %> 
    </div>
  </div>
</div>

<div class="row my-3">
  <div class="col-sm-5">
    <%= render "shared/new_comment" %>
  </div>
</div>


<%= render "shared/comments" %>

<%= paginate @comments %>


